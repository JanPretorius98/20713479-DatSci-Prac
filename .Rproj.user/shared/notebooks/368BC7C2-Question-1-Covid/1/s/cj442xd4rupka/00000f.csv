"0","# Create data frame with cumulative vaccinations by date for each continent"
"0","df_vaccinations <- df_covid %>%"
"0","    filter(!is.na(continent)) %>%"
"0","    group_by(continent, date) %>%"
"0","    summarize("
"0","        total_vaccinations = sum(people_vaccinated, na.rm = TRUE),"
"0","        population = sum(population, na.rm = TRUE),"
"0","        .groups = ""drop"""
"0","    ) %>%"
"0","    mutate(total_vaccinations_per_hundred = total_vaccinations / (population / 100)) %>%"
"0","    arrange(continent, date) %>%"
"0","    group_by(continent) %>%"
"0","    mutate(vaccination_30day_avg = rollmean(total_vaccinations_per_hundred, 30, fill = NA, align = ""right""))"
"0",""
"0",""
"0","# Plot 7-day average of vaccinations per hundred over time, colored by continent"
"0","df_vaccinations %>%"
"0","    filter(date > as.Date(""2021-01-01"")) %>% "
"0","    ggplot(aes(x = date, y = vaccination_30day_avg, color = continent)) +"
"0","    geom_line(size = 1) +"
"0","    scale_color_manual(values=palette) +"
"0","    th + "
"0","    theme(legend.position = ""bottom"") +"
"0","    labs(x = ""Date"", y = ""People Vaccinated Per Hundred*"", color = ""Continent"","
"0","         caption = ""*30-day Average"","
"0","         title = ""Figure 4: People vaccinated over time by continent."")"
