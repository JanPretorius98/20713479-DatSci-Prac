"0","# Aggregate the data and calculate cumulative cases and deaths"
"0","df_covid_cumulative <- df_covid %>%"
"0","    filter(!is.na(continent)) %>%"
"0","    group_by(continent, date) %>%"
"0","    summarise("
"0","        new_cases = sum(new_cases, na.rm = TRUE),"
"0","        new_deaths = sum(new_deaths, na.rm = TRUE),"
"0","        .groups = ""drop"""
"0","    ) %>%"
"0","    arrange(continent, date) %>%"
"0","    group_by(continent) %>%"
"0","    mutate("
"0","        total_cases = cumsum(new_cases),"
"0","        total_deaths = cumsum(new_deaths),"
"0","        death_proportion = total_deaths / total_cases"
"0","    )"
"0",""
"0","# Convert from wide to long format for plotting"
"0","df_prop <- df_covid_cumulative %>%"
"0","    pivot_longer(cols = c(total_cases, total_deaths, death_proportion), names_to = ""category"", values_to = ""count"")"
"0",""
"0","# Filter to include only death_proportion"
"0","df_prop_deaths <- df_prop %>%"
"0","    filter(category == ""death_proportion"")"
"0",""
"0","# Define the months of interest"
"0","months_of_interest <- as.Date(c(""2020-06-01"", ""2020-12-01"", ""2021-06-01"", ""2021-12-01"", ""2022-06-01""))"
"0",""
"0","# Calculate the sum of deaths and cases for each continent and month"
"0","df_summaries <- df_covid %>%"
"0","  group_by(continent, date = floor_date(date, ""month"")) %>%"
"0","  summarize(total_deaths = sum(new_deaths, na.rm = TRUE), "
"0","            total_cases = sum(new_cases, na.rm = TRUE), "
"0","            .groups = ""drop"") %>%"
"0","  mutate(death_proportion = total_deaths / total_cases) %>%"
"0","  filter(date %in% months_of_interest)"
"0",""
"0","# Filter to include only death_proportion and the dates of interest"
"0","df_summaries <- df_covid_cumulative %>%"
"0","    filter(date %in% months_of_interest) %>%"
"0","    select(date, continent, death_proportion)"
"0",""
"0","# Pivot wider to get continents as columns"
"0","df_wide <- df_summaries %>%"
"0","  pivot_wider(names_from = continent, values_from = death_proportion)"
"0",""
"0","# Convert date to character for display purposes"
"0","df_wide <- df_wide %>%"
"0","  mutate(date = as.character(date))"
"0",""
